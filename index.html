<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>動物麻醉監測記錄</title>
    <link rel="stylesheet" href="app.css" />
    <link rel="icon" type="image/png" href="螢幕擷取畫面 2025-11-24 013105.png" />
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#0b1e3b" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="apple-mobile-web-app-title" content="麻醉監測" />
    <link rel="apple-touch-icon" href="螢幕擷取畫面 2025-11-24 013105.png" />
  </head>
  <body>
    <div class="container">
      <div class="brand">
        <img src="螢幕擷取畫面 2025-11-24 013105.png" alt="Nar Animal Hospital" onerror="this.style.display='none'" />
        <div class="brand-text">
          <div class="zh">納爾動物醫院</div>
          <div class="en">Nar Animal Hospital</div>
        </div>
        <div class="app-title">動物麻醉監測記錄</div>
        <a href="monitor.html" style="margin-left:12px" class="secondary" id="open-monitor-btn">進階監控介面</a>
      </div>
      <section class="card">
        <div class="metrics">
          <div class="metric" id="card-hr"><div class="label">HR</div><div class="value" id="val-hr">--</div><div class="unit">bpm</div></div>
          <div class="metric" id="card-bp"><div class="label">BP (MAP)</div><div class="value" id="val-bp">--</div><div class="unit">mmHg</div></div>
          <div class="metric" id="card-rr"><div class="label">RR</div><div class="value" id="val-rr">--</div><div class="unit">bpm</div></div>
          <div class="metric" id="card-spo2"><div class="label">SpO₂</div><div class="value" id="val-spo2">--</div><div class="unit">%</div></div>
          <div class="metric" id="card-etco2"><div class="label">EtCO₂</div><div class="value" id="val-etco2">--</div><div class="unit">mmHg</div></div>
          <div class="metric" id="card-temp"><div class="label">Temp</div><div class="value" id="val-temp">--</div><div class="unit">°C</div></div>
        </div>
        <div class="legend">
          <span class="dot hr">HR</span>
          <span class="dot rr">RR</span>
          <span class="dot sys">Sys</span>
          <span class="dot dia">Dia</span>
          <span class="dot spo2">SpO₂</span>
          <span class="dot etco2">EtCO₂</span>
        </div>
        <canvas id="trend" height="220"></canvas>
      </section>

      <section class="card">
        <div class="bolus">
          <div class="bolus-header">
            <div>BOLUS</div>
            <button type="button" id="add-bolus" class="secondary">+</button>
          </div>
          <div class="bolus-list" id="bolus-list"></div>
        </div>
      </section>

      <section class="card">
        <div class="timeline-header">
          <div>紀錄流水帳</div>
          <button type="button" id="add-event" class="secondary">新增事件</button>
        </div>
        <div class="timeline" id="timeline"></div>
      </section>

      <section class="card">
        <h2>個案資訊</h2>
        <form id="case-form">
          <div class="grid-2">
            <label>物種
              <select id="species" required>
                <option value="dog">犬</option>
                <option value="cat">貓</option>
                <option value="rabbit">兔</option>
                <option value="other">其他</option>
              </select>
            </label>
            <label>品種
              <input id="breed" type="text" />
            </label>
            <label>姓名
              <input id="name" type="text" />
            </label>
            <label>性別
              <input id="sex" type="text" />
            </label>
            <label>年齡(歲)
              <input id="age" type="number" min="0" step="0.1" />
            </label>
            <label>體重(kg)
              <input id="weight" type="number" min="0" step="0.1" />
            </label>
            <label>ASA 等級
              <select id="asa">
                <option value="I">I</option>
                <option value="II">II</option>
                <option value="III">III</option>
                <option value="IV">IV</option>
                <option value="V">V</option>
              </select>
            </label>
            <label>麻醉師
              <input id="anesthetist" type="text" />
            </label>
            <label>手術名稱
              <input id="procedure" type="text" />
            </label>
            <label>開始時間
              <input id="startTime" type="datetime-local" />
            </label>
            <label>用藥摘要
              <input id="drugs" type="text" placeholder="鎮靜/誘導/維持/止痛" />
            </label>
          </div>
          <div class="actions">
            <button type="button" id="save-case">儲存個案</button>
            <button type="button" id="new-case" class="secondary">新建個案</button>
          </div>
        </form>
      </section>

      <section class="card">
        <h2>即時監測紀錄</h2>
        <form id="reading-form">
          <div class="grid-3">
            <label>時間
              <input id="timestamp" type="datetime-local" />
            </label>
            <label>心率 HR(bpm)
              <input id="hr" type="number" min="0" step="1" />
            </label>
            <label>呼吸 RR(bpm)
              <input id="rr" type="number" min="0" step="1" />
            </label>
            <label>血氧 SpO₂(%)
              <input id="spo2" type="number" min="0" max="100" step="1" />
            </label>
            <label>體溫(°C)
              <input id="temp" type="number" step="0.1" />
            </label>
            <label>呼末二氧化碳 EtCO₂(mmHg)
              <input id="etco2" type="number" step="1" />
            </label>
            <label>收縮壓 SBP(mmHg)
              <input id="sbp" type="number" step="1" />
            </label>
            <label>舒張壓 DBP(mmHg)
              <input id="dbp" type="number" step="1" />
            </label>
            <label>平均壓 MAP(mmHg)
              <input id="map" type="number" step="1" />
            </label>
            <label>O₂ 流量(L/min)
              <input id="o2" type="number" step="0.1" />
            </label>
            <label>備註
              <input id="note" type="text" />
            </label>
          </div>
          <div class="actions">
            <button type="button" id="add-reading">加入紀錄</button>
            <button type="button" id="export-csv" class="secondary">匯出 CSV</button>
            <span style="flex:1"></span>
            <label style="flex:0 0 180px">間隔(分鐘)
              <input id="intervalMin" type="number" min="1" step="1" value="5" />
            </label>
            <button type="button" id="start-timer" class="secondary">開始定時</button>
            <button type="button" id="stop-timer" class="secondary">停止定時</button>
          </div>
        </form>

        <div class="table-wrap">
          <table id="readings-table">
            <thead>
              <tr>
                <th>時間</th>
                <th>HR</th>
                <th>RR</th>
                <th>SpO₂</th>
                <th>體溫</th>
                <th>EtCO₂</th>
                <th>SBP</th>
                <th>DBP</th>
                <th>MAP</th>
                <th>O₂</th>
                <th>備註</th>
                <th></th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>
    </div>
    <script src="app.js"></script>
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', function(){
          navigator.serviceWorker.register('sw.js');
        });
      }
    </script>
  </body>
</html>